<!DOCTYPE html>
<html>
<head>
<style>
body {background-color: powderblue;}
h1   {color: blue;}
p    {color: red;font-family: "Times New Roman", Times, serif;}
</style>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

<script>
  google.charts.load('current', {'packages':['table']});
   
   function initialize(desiredName) {
   
   desiredName = document.getElementById("name").value;
   
   var dataSourceUrl = 'http://spreadsheets.google.com/tq?key=1ASVFGT_jC5hEG7PE8k5rL7_JJlIZOp_yiRFmsclXThk&pub=1';
   
  var opts = {sendMethod: 'auto'};
  // Replace the data source URL on next line with your data source URL.
  var query = new google.visualization.Query(dataSourceUrl, opts);
     

  var queryClause = '"SELECT "&SUBSTITUTE(ADDRESS(1,MATCH(' + desiredName + ',data!A1:NO1,0),4),1,"")';
  
     queryClause = SQL("data!A1:NO1","SELECT " + desiredName,false)
     
     //queryClause = "select  match(" + desiredName + "
     
  //queryClause = "select A";
     
  query.setQuery(queryClause);

  // Send the query with a callback function.
  query.send(handleQueryResponse);
}

function handleQueryResponse(response) {
  // Called when the query response is returned.
  
  
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

  var data = response.getDataTable();
  
  
  
  var table = new google.visualization.Table(document.getElementById('table'));

  table.draw(data, {showRowNumber: true, width: '100%', height: '100%'});
  
  //var container = document.getElementById("table");
  
  
  
  //var chart = new google.visualization.PieChart(document.getElementById('table'));
  //chart.draw(data, {width: 400, height: 240, is3D: true});
  
}

    /*
    var query, options, container;

    function init() {
      query = new google.visualization.Query(dataSourceUrl);
      container = document.getElementById("table");
      options = {'pageSize': 5};
      sendAndDraw();
    }

    function sendAndDraw() {
      query.abort();
      var tableQueryWrapper = new TableQueryWrapper(query, container, options);
      tableQueryWrapper.sendAndDraw();
    }


    function setOption(prop, value) {
      options[prop] = value;
      sendAndDraw();
    }
    */

  </script>


</head>
<body>


Insert full name (capitalize first and last; e.g. "Hakan Alpay")<br>


<textarea rows="1" cols="30" id="name"></textarea>

<button onClick="initialize()">Find my compatible roomies!</button>

<p id="debug"></p>


<!--
<form action="">
  Number of rows to show:
  <select onChange="setOption('pageSize', parseInt(this.value, 10))">
    <option value="0">0</option>
    <option value="3">3</option>
    <option selected=selected value="5">5</option>
    <option value="8">8</option>
    <option value="-1">-1</option>
  </select>
</form>
<br />
-->

<div id="table"></div>





</body>
</html>
